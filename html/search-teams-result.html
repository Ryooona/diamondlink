<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DiamondLink | チーム検索結果</title>
  <link rel="icon" href="/diamondlink/images/fabicon_square.png" type="image/png">
  <link rel="stylesheet" href="/diamondlink/css/style.css?v=2">
  <link rel="stylesheet" href="/diamondlink/css/header.css">

 <style>
body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: url('/diamondlink/images/background-1.png'); /* ←背景画像リンク*/
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 0.2;
  z-index: -1;
}
</style>

  <style>
.flex-fields {
  display: flex;
  gap: 20px; /* 並びの間のすき間（お好みで調整可） */
  align-items: flex-end; /* ラベルの下ラインを揃える */
}

.flex-fields label {
  display: flex;
  flex-direction: column; /* ラベルと入力欄は縦並び */
}
</style>

</head>
<body>

  <!-- 共通ヘッダー挿入 -->
  <div id="header-placeholder"></div>

  <!-- メインコンテンツ -->
  <main class="container">
    <div class="fade-in-section">
    <h1>チーム検索結果</h1>

    <h2>検索フォーム</h2>
<div class="card fade-in-section">
<form id="search-form" action="search-teams-result.html" method="GET">
  <div class="search-form">

    <!-- 都道府県 -->
    <label for="search-prefecture">都道府県：</label>
    <select id="search-prefecture" name="search-prefecture" required>
      <option value="">選択してください</option>
    </select><br><br>

    <!-- 競技種別と区分 -->
<div class="flex-fields">
  <label for="search-competition">競技種別：</label>
  <select id="search-competition" name="search-competition">
    <option value="">指定なし</option>
    <option value="野球">野球</option>
    <option value="ソフトボール">ソフトボール</option>
  </select>

  <label for="search-division">区分：</label>
  <select id="search-division" name="search-division" disabled>
    <option value="">選択してください</option>
  </select>
</div>
<br>

    <!-- チーム構成 -->
    <label for="search-team">チーム構成：</label>
    <select id="search-team" name="search-team">
      <option value="">指定なし</option>
      <option value="男子">男子</option>
      <option value="女子">女子</option>
      <option value="混合">混合</option>
    </select><br><br>

    <!-- フリーワード -->
    <label for="search-keyword">フリーワード検索：</label>
    <input type="text" id="search-keyword" name="search-keyword" class="long-input" placeholder="例：東京　女子　ゴムソフトボール"><br><br>

    <button type="submit" class="main-button">検索する</button>
    <p style="font-size: small; color: gray;">※現在は検索機能は未対応です</p>
  </div>
</form>
</div>

    <hr>

    <h2>チーム一覧</h2>
    <ul id="team-list"></ul>

    <div id="pagination" class="pagination"></div>

    <hr>
    <a href="index.html">← トップに戻る</a>
   </div>   
  </main>

  <!-- 共通フッター挿入 -->
  <div id="footer-placeholder"></div>

  <!-- ログインモーダル -->
<div id="login-modal" class="modal">
  <!-- ログインフォームをあとで入れる -->
</div>

<!-- サインアップモーダル -->
<div id="signup-modal" class="modal">
  <!-- サインアップフォームをあとで入れる -->
</div>

  <!-- 1. ヘッダー＆フッター読込 -->
<script src="/diamondlink/js/header-loader.js"></script>

<!-- 2. 都道府県だけロード -->
<script src="/diamondlink/js/prefecture-only-loader.js"></script>

<!-- 3. ダミーチームリスト -->
<script src="/diamondlink/js/dummy-team-list.js"></script>

<!-- 4. モーダル管理 -->
<script src="/diamondlink/js/login-modal.js"></script>
<script src="/diamondlink/js/common.js"></script>

<!-- 5. 競技種別と区分の連動 -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const sportType = document.getElementById('search-competition');
  const division = document.getElementById('search-division');

  sportType.addEventListener('change', function() {
    division.innerHTML = '<option value="">選択してください</option>';
    if (sportType.value === "野球") {
      division.disabled = false;
      ["指定なし", "軟式", "準硬式", "硬式"].forEach(opt => {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        division.appendChild(option);
      });
    } else if (sportType.value === "ソフトボール") {
      division.disabled = false;
      ["指定なし", "ゴム", "革"].forEach(opt => {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        division.appendChild(option);
      });
    } else {
      division.disabled = true;
    }
  });
});
</script>

<!-- 6. URLパラメータからフォームに反映（区分も連動させる版） -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const prefectureSelect = document.getElementById('search-prefecture');

  function applyURLParams() {
    const urlParams = new URLSearchParams(window.location.search);

    const prefecture = urlParams.get('search-prefecture');
    const competition = urlParams.get('search-competition');
    const division = urlParams.get('search-division');
    const team = urlParams.get('search-team');
    const keyword = urlParams.get('search-keyword');

    if (prefecture) {
      prefectureSelect.value = prefecture;
    }
    if (competition) {
      document.getElementById('search-competition').value = competition;
      const event = new Event('change');
      document.getElementById('search-competition').dispatchEvent(event);

      setTimeout(() => {
        if (division) {
          document.getElementById('search-division').value = division;
        }
      }, 100);
    }
    if (team) {
      document.getElementById('search-team').value = team;
    }
    if (keyword) {
      document.getElementById('search-keyword').value = keyword;
    }
  }

  // 都道府県リストが読み込まれるまで待つ
  const observer = new MutationObserver(() => {
    if (prefectureSelect.options.length > 1) {
      applyURLParams();
      observer.disconnect();
    }
  });

  observer.observe(prefectureSelect, { childList: true });
});
</script>

<!-- 7. ダミーチーム検索＆表示 -->
<!-- 7. ダミーチーム検索＆カード表示 -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const urlParams = new URLSearchParams(window.location.search);

  const prefecture = urlParams.get('search-prefecture') || '';
  const competition = urlParams.get('search-competition') || '';
  const division = urlParams.get('search-division') || '';
  const team = urlParams.get('search-team') || '';
  const keyword = urlParams.get('search-keyword') || '';

  const filteredTeams = dummyTeams.filter(teamData => {
    if (prefecture && teamData.prefecture !== prefecture) return false;
    if (competition && teamData.competition !== competition) return false;
    if (division && teamData.division !== division) return false;
    if (team && teamData.teamType !== team) return false;
    if (keyword) {
      const lowerKeyword = keyword.toLowerCase();
      if (
        !teamData.name.toLowerCase().includes(lowerKeyword) &&
        !teamData.description.toLowerCase().includes(lowerKeyword)
      ) {
        return false;
      }
    }
    return true;
  });

  const teamList = document.getElementById('team-list');
  teamList.innerHTML = '';

  if (filteredTeams.length === 0) {
    teamList.innerHTML = '<p>条件に一致するチームがありませんでした。</p>';
  } else {
    filteredTeams.forEach(teamData => {
      const card = document.createElement('a');
      card.className = 'team-card';
      card.href = '/diamondlink/teams/sample-team.html'; // 仮リンク（あとで動的にできる）

      card.innerHTML = `
        <div class="team-card-inner">
          <div class="team-thumbnail">
            <img src="/diamondlink/images/sample-thumbnail.png" alt="サムネイル">
          </div>
          <div class="team-info">
            <h3 class="team-name">${teamData.name}</h3>
            <p class="team-meta">${teamData.prefecture}／市区町村　${teamData.ageGroup || '一般'}／${teamData.teamType}　${teamData.division}・${teamData.competition}</p>
            <p class="team-practice">練習日：毎週 土曜日</p> <!-- 仮データ -->
            <div class="team-sns">
              ${teamData.xUrl ? `<a href="${teamData.xUrl}" target="_blank"><img src="/diamondlink/images/icon-x.svg" alt="X"></a>` : ''}
              ${teamData.instagramUrl ? `<a href="${teamData.instagramUrl}" target="_blank"><img src="/diamondlink/images/icon-instagram.svg" alt="Instagram"></a>` : ''}
              ${teamData.youtubeUrl ? `<a href="${teamData.youtubeUrl}" target="_blank"><img src="/diamondlink/images/icon-youtube.svg" alt="YouTube"></a>` : ''}
            </div>
            <p class="team-description">${teamData.description}</p>
          </div>
        </div>
      `;

      teamList.appendChild(card);
    });
  }
});
</script>
